<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noto Sans Math SVG Renderer</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Math:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/opentype.js@1.3.4/dist/opentype.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        svg {
            border: 1px solid #ccc;
            margin: 10px 0;
        }
        #widthDisplay {
            font-family: monospace;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <label for="fontSize">Font Size: <span id="sizeValue">24</span>px</label>
    <input type="range" id="fontSize" min="12" max="72" value="24" step="1">
    
    <svg width="800" height="200" id="mySvg">
        <!-- Text elements will be added here -->
    </svg>
    
    <div id="widthDisplay">
        Width of variable1: <span id="widthValue1">0</span>px<br>
        Width of variable2: <span id="widthValue2">0</span>px
    </div>

    <script>
        // Define the strings
        const variable1 = "variable1";
        const variable2 = "variable2";

        let font = null;

        // Get DOM elements
        const fontSizeSlider = document.getElementById('fontSize');
        const sizeValue = document.getElementById('sizeValue');
        const svg = document.getElementById('mySvg');
        const widthValue1 = document.getElementById('widthValue1');
        const widthValue2 = document.getElementById('widthValue2');

        // Create text elements
        const text1 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text1.setAttribute('x', '10');
        text1.setAttribute('y', '50');
        text1.setAttribute('font-family', 'Noto Sans Math');
        text1.setAttribute('font-size', '24');
        text1.setAttribute('fill', 'black');
        text1.textContent = variable1;
        svg.appendChild(text1);

        const text2 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text2.setAttribute('x', '200'); // Initial position, will be adjusted
        text2.setAttribute('y', '50');
        text2.setAttribute('font-family', 'Noto Sans Math');
        text2.setAttribute('font-size', '24');
        text2.setAttribute('fill', 'black');
        text2.textContent = variable2;
        svg.appendChild(text2);

        // Width display texts in SVG
        const widthText1 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        widthText1.setAttribute('x', '10');
        widthText1.setAttribute('y', '100');
        widthText1.setAttribute('font-family', 'Arial');
        widthText1.setAttribute('font-size', '14');
        widthText1.setAttribute('fill', 'gray');
        svg.appendChild(widthText1);

        const widthText2 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        widthText2.setAttribute('x', '10');
        widthText2.setAttribute('y', '120');
        widthText2.setAttribute('font-family', 'Arial');
        widthText2.setAttribute('font-size', '14');
        widthText2.setAttribute('fill', 'gray');
        svg.appendChild(widthText2);

        // Custom function to compute advance width by looping over glyphs
        function computeAdvanceWidth(font, text, fontSize, options = { kerning: true }) {
            const glyphs = font.stringToGlyphs(text);
            const scale = fontSize / font.unitsPerEm;
            let width = 0;
            for (let i = 0; i < glyphs.length; i++) {
                const glyph = glyphs[i];
                width += glyph.advanceWidth * scale;
                if (options.kerning && i < glyphs.length - 1) {
                    const kerningValue = font.getKerningValue(glyph, glyphs[i + 1]);
                    width += kerningValue * scale;
                }
            }
            return width;
        }

        async function loadFont() {
            try {
                // Hardcode the font URL to avoid regex issues
                const fontUrl = 'https://fonts.gstatic.com/s/notosansmath/v36/BXTdSY8qK9tX1t8T4dsE8A.woff2';
                const fontRes = await fetch(fontUrl);
                if (!fontRes.ok) throw new Error(`HTTP ${fontRes.status}`);
                const buffer = await fontRes.arrayBuffer();
                font = opentype.parse(buffer);
                console.log('Font loaded successfully');
                console.log('unitsPerEm:', font.unitsPerEm);
                updateRendering();
            } catch (e) {
                console.error('Error loading font:', e);
            }
        }

        function updateRendering() {
            if (!font) {
                console.log('Font not loaded yet');
                return;
            }

            const fontSize = parseFloat(fontSizeSlider.value);
            sizeValue.textContent = fontSize;

            // Update font-size on text elements
            text1.setAttribute('font-size', fontSize);
            text2.setAttribute('font-size', fontSize);

            // Compute widths using custom glyph loop method
            const width1 = computeAdvanceWidth(font, variable1, fontSize, { kerning: true });
            const width2 = computeAdvanceWidth(font, variable2, fontSize, { kerning: true });

            // Position text2 adjacent to text1
            text2.setAttribute('x', 10 + width1 + 10); // 10px gap

            // Update display values
            widthValue1.textContent = width1.toFixed(2);
            widthValue2.textContent = width2.toFixed(2);

            // Update width texts in SVG
            widthText1.textContent = `Width of ${variable1}: ${width1.toFixed(2)}px`;
            widthText2.textContent = `Width of ${variable2}: ${width2.toFixed(2)}px`;
        }

        // Load font on init
        loadFont();

        // Event listener for slider
        fontSizeSlider.addEventListener('input', updateRendering);
    </script>
</body>
</html>
```​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​