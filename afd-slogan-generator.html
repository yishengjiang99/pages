<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>AfD Poster Generator</title>
	<style>
		body {
			font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
			display: flex;
			gap: 20px;
			padding: 20px;
		}

		.controls {
			width: 320px;
		}

		canvas {
			border: 1px solid #ddd;
			box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
			background: #fff;
		}

		label {
			display: block;
			margin-top: 12px;
			font-size: 14px;
			color: #333;
		}

		input[type="text"],
		button,
		select {
			width: 100%;
			padding: 8px;
			margin-top: 6px;
			box-sizing: border-box;
			font-size: 14px;
		}

		.small {
			font-size: 12px;
			color: #666;
			margin-top: 8px;
		}

	</style>
</head>
<body>

	<div class="controls">
		<h3>AfD Poster Generator</h3>
		<i>turn leftist propagenda into resistence</i>

		<label>Upload tweet image (screenshot)
			<input id="fileInput" type="file" accept="image/*">
		</label>

		<label>Or image URL
			<input id="urlInput" type="text" placeholder="https://...jpg (optional)">
		</label>

		<label>Slogan text
			<input id="slogan" type="text" value="Our Voices, Our Future">
		</label>

		<label>CTA footer text
			<input id="cta" type="text" value="Join us today">
		</label>

		<label>Canvas size
			<select id="size">
				<option value="800x1200">800 × 1200 (portrait)</option>
				<option value="1200x800">1200 × 800 (landscape)</option>
				<option value="1000x1500">1000 × 1500 (high-res)</option>
			</select>
		</label>

		<button id="renderBtn">Render Poster</button>
		<button id="downloadBtn" style="margin-top:8px;">Download PNG</button>

		<p class="small">Tip: If you already have an image file (you uploaded earlier), use Upload. Otherwise paste an
			image URL.</p>
	</div>

	<canvas id="posterCanvas" width="800" height="1200"></canvas>


	<script>
		(() => {
			const canvas = document.getElementById('posterCanvas');
			const ctx = canvas.getContext('2d');

			const filxeInput = document.getElementById('fileInput');
			const urlInput = document.getElementById('urlInput');
			const sloganInput = document.getElementById('slogan');
			const ctaInput = document.getElementById('cta');
			const sizeSelect = document.getElementById('size');
			const renderBtn = document.getElementById('renderBtn');
			const downloadBtn = document.getElementById('downloadBtn');

			let uploadedImage = null;
			let aliceImage = new Image();
			let aliceImageLoaded = false;

			// Preload alice.png
			aliceImage.src = 'alice.png';
			aliceImage.onload = () => {
				aliceImageLoaded = true;
				renderPoster();

			};
			aliceImage.onerror = () => {
				console.warn('Failed to load alice.png');
				aliceImageLoaded = false;
			};

			// Helper: rounded rect
			function roundRect(ctx, x, y, w, h, r) {
				const radius = Math.min(r, w / 2, h / 2);
				ctx.beginPath();
				ctx.moveTo(x + radius, y);
				ctx.arcTo(x + w, y, x + w, y + h, radius);
				ctx.arcTo(x + w, y + h, x, y + h, radius);
				ctx.arcTo(x, y + h, x, y, radius);
				ctx.arcTo(x, y, x + w, y, radius);
				ctx.closePath();
			}

			// Helper: draw wrapped text centered in a rectangle, large font scaling
			function drawWrappedText(ctx, text, boxX, boxY, boxW, boxH, maxFontPx, minFontPx = 18) {
				if (!text.trim()) {
					ctx.fillStyle = '#999';
					ctx.font = '20px Arial';
					ctx.textAlign = 'center';
					ctx.textBaseline = 'middle';
					ctx.fillText('Enter a slogan', boxX + boxW / 2, boxY + boxH / 2);
					return;
				}

				let fontSize = maxFontPx;
				ctx.textAlign = 'left';
				ctx.textBaseline = 'top';
				const words = text.split(/\s+/);
				let lines;
				while (fontSize >= minFontPx) {
					ctx.font = `bold ${fontSize}px Helvetica, Arial, sans-serif`;
					lines = [];
					let line = '';
					for (let w of words) {
						const test = line ? (line + ' ' + w) : w;
						if (ctx.measureText(test).width <= boxW - 20) {
							line = test;
						} else {
							if (line) lines.push(line);
							line = w;
						}
					}
					if (line) lines.push(line);
					const totalHeight = lines.length * (fontSize * 1.05);
					if (totalHeight <= boxH - 20) break;
					fontSize -= 2;
				}

				ctx.fillStyle = '#ffffff';
				ctx.fillStyle = '#0f2140';

				ctx.textAlign = 'center';
				ctx.textBaseline = 'top';
				ctx.font = `bold ${fontSize}px Helvetica, Arial, sans-serif`;
				const startY = boxY + (boxH - lines.length * (fontSize * 1.05)) / 2;
				const cx = boxX + boxW / 2;
				let y = startY;
				for (let line of lines) {
					ctx.fillText(line, cx, y);
					y += fontSize * 1.05;
				}
			}

			// Draw image from alice.png
			function drawSilhouette(ctx, x, y, w, h) {
				if (aliceImageLoaded && aliceImage) {
					// Scale image to fit within w and h, preserving aspect ratio
					const scale = Math.min(w / aliceImage.width, h / aliceImage.height);
					const drawW = aliceImage.width * scale;
					const drawH = aliceImage.height * scale;
					const dx = x + (w - drawW) / 2; // Center horizontally
					const dy = y + (h - drawH) / 2; // Center vertically
					ctx.drawImage(aliceImage, dx, dy, drawW, drawH);
				} else {
					// Fallback placeholder if image fails to load
					ctx.fillStyle = '#18324a';
					roundRect(ctx, x, y, w, h, 12);
					ctx.fill();
					ctx.fillStyle = '#ffffff';
					ctx.font = '12px Arial';
					ctx.textAlign = 'center';
					ctx.textBaseline = 'middle';
					ctx.fillText('alice.png not found', x + w / 2, y + h / 2);
				}
			}

			function clearCanvas() {
				ctx.clearRect(0, 0, canvas.width, canvas.height);
			}

			function renderPoster() {
				console.log('Canvas size:', canvas.width, canvas.height);
				clearCanvas();
				const W = canvas.width, H = canvas.height;

				const g = ctx.createLinearGradient(0, 0, 0, H);
				g.addColorStop(0, '#d5eefc');
				g.addColorStop(1, '#ffffff');
				ctx.fillStyle = g;
				ctx.fillRect(0, 0, W, H);

				const margin = Math.round(W * 0.06);
				const cardX = margin, cardY = margin, cardW = W - margin * 2, cardH = H - margin * 2;
				ctx.save();
				ctx.shadowColor = 'rgba(0,0,0,0.18)';
				ctx.shadowBlur = 24;
				ctx.shadowOffsetY = 8;
				ctx.fillStyle = '#ffffff';
				roundRect(ctx, cardX, cardY, cardW, cardH, 18);
				ctx.fill();
				ctx.restore();

				const pad = Math.round(cardW * 0.04);
				let cursorY = cardY + pad;

				const tweetAreaH = Math.round(cardH * 0.36);
				const tweetAreaX = cardX + pad;
				const tweetAreaY = cursorY;
				const tweetAreaW = cardW - pad * 2;

				ctx.save();
				roundRect(ctx, tweetAreaX, tweetAreaY, tweetAreaW, tweetAreaH, 12);
				ctx.clip();
				ctx.fillStyle = '#f8fbff';
				ctx.fillRect(tweetAreaX, tweetAreaY, tweetAreaW, tweetAreaH);

				if (uploadedImage) {
					const img = uploadedImage;
					const scale = Math.max(tweetAreaW / img.width, tweetAreaH / img.height);
					const drawW = img.width * scale;
					const drawH = img.height * scale;
					const dx = tweetAreaX + (tweetAreaW - drawW) / 2;
					const dy = tweetAreaY + (tweetAreaH - drawH) / 2;
					ctx.drawImage(img, dx, dy, drawW, drawH);
				} else {
					ctx.fillStyle = '#e6f0fb';
					ctx.fillRect(tweetAreaX, tweetAreaY, tweetAreaW, tweetAreaH);
					ctx.fillStyle = '#9bbfe6';
					ctx.font = '20px Arial';
					ctx.textAlign = 'center';
					ctx.textBaseline = 'middle';
					ctx.fillText('Tweet image placeholder', tweetAreaX + tweetAreaW / 2, tweetAreaY + tweetAreaH / 2 - 10);
					ctx.font = '12px Arial';
					ctx.fillText('Upload an image at left or paste a URL', tweetAreaX + tweetAreaW / 2, tweetAreaY + tweetAreaH / 2 + 14);
				}
				ctx.restore();
				ctx.setTransform(1, 0, 0, 1, 0, 0);

				cursorY = tweetAreaY + tweetAreaH + pad;

				const sloganBoxX = tweetAreaX;
				const sloganBoxY = cursorY;
				const sloganBoxW = tweetAreaW;
				const sloganBoxH = Math.round(cardH * 0.55);
				ctx.fillStyle = '#eef7fb';

				roundRect(ctx, sloganBoxX, sloganBoxY, sloganBoxW, sloganBoxH, 14);
				ctx.fill();

				drawWrappedText(ctx, sloganInput.value || 'Our Voices, Our Future', sloganBoxX, sloganBoxY, sloganBoxW, sloganBoxH, Math.round(sloganBoxW * 0.12));

				const silW = Math.round(sloganBoxW * 0.26);
				const silH = Math.round(sloganBoxH * 0.50);
				const silX = sloganBoxX + sloganBoxW - silW - 12;
				const silY = sloganBoxY + sloganBoxH - silH - 12;
				drawSilhouette(ctx, silX, silY, silW, silH);

				const footerH = Math.round(cardH * 0.12);
				const footerX = cardX;
				const footerY = cardY + cardH - footerH;
				ctx.fillStyle = '#18324a';
				roundRect(ctx, footerX, footerY, cardW, footerH, 12);
				ctx.fill();

				const logoW = Math.round(footerH * 0.9);
				const logoH = logoW;
				const logoX = footerX + pad;
				const logoY = footerY + (footerH - logoH) / 2;
				ctx.fillStyle = '#37a2dc';
				roundRect(ctx, logoX, logoY, logoW, logoH, 8);
				ctx.fill();
				ctx.fillStyle = '#ffffff';
				ctx.font = `${Math.round(logoW * 0.22)}px Arial`;
				ctx.textAlign = 'center';
				ctx.textBaseline = 'middle';
				ctx.fillText('AfD', logoX + logoW / 2, logoY + logoH / 2 - 8);
				ctx.font = `${Math.round(logoW * 0.16)}px Arial`;
				ctx.fillText('<', logoX + logoW / 2, logoY + logoH / 2 + 12);

				ctx.fillStyle = '#ffffff';
				ctx.textAlign = 'left';
				ctx.textBaseline = 'middle';
				ctx.font = `bold ${Math.round(footerH * 0.38)}px Arial`;
				const ctaText = ctaInput.value || 'Join us today';
				const ctaX = logoX + logoW + 20;
				if (ctaX + ctx.measureText(ctaText).width > canvas.width) {
					console.warn('CTA text may be clipped:', ctaX, ctaText);
				}
				ctx.fillText(ctaText, ctaX, footerY + footerH / 2);
				ctx.fillStyle = 'rgba(255,255,255,0.75)';
				ctx.textAlign = 'right';
				ctx.font = `${Math.round(footerH * 0.12)}px Arial`;
				ctx.fillText('www.afd.de', footerX + cardW - pad, footerY + footerH / 2);
			}

			fileInput.addEventListener('change', (ev) => {
				const f = ev.target.files && ev.target.files[0];
				if (!f) return;
				const img = new Image();
				img.onload = () => {
					uploadedImage = img;
				};
				img.onerror = () => {
					uploadedImage = null;
					alert('Could not load that image file.');
				};
				img.src = URL.createObjectURL(f);
			});

			function loadImageFromUrl(url) {
				return new Promise((resolve, reject) => {
					if (!url) return reject('No url');
					const img = new Image();
					img.crossOrigin = 'anonymous';
					img.onload = () => resolve(img);
					img.onerror = (e) => reject(e);
					img.src = url;
				});
			}

			renderBtn.addEventListener('click', async () => {
				const [w, h] = sizeSelect.value.split('x').map(x => parseInt(x, 10));
				canvas.width = w;
				canvas.height = h;

				const url = urlInput.value.trim();
				if (url && !uploadedImage) {
					try {
						uploadedImage = await loadImageFromUrl(url);
					} catch (e) {
						console.warn('Failed to load remote image:', e);
						alert('Could not load image from URL (CORS or invalid URL). Use file upload if possible.');
					}
				}
				renderPoster();
			});

			downloadBtn.addEventListener('click', () => {
				const link = document.createElement('a');
				link.download = 'neutral_poster.png';
				link.href = canvas.toDataURL('image/png');
				link.click();
			});

		})();
	</script>

<!-- NAVIGATION INJECTED -->
<style>
  body { margin: 0; font-family: Arial, sans-serif; }
  header {
    background: #333; color: white; padding: 10px 20px;
    display: flex; justify-content: space-between; align-items: center;
    position: sticky; top: 0; z-index: 1000;
  }
  header a { color: white; text-decoration: none; font-weight: bold; }
  .menu-btn { background: none; border: none; color: white; font-size: 1.5em; cursor: pointer; }
  .drawer {
    height: 100%; width: 250px; position: fixed; top: 0; left: -250px;
    background: #444; overflow-x: hidden; transition: 0.3s; padding-top: 60px;
    z-index: 999;
  }
  .drawer.open { left: 0; }
  .drawer a {
    padding: 10px 20px; text-decoration: none; color: white; display: block;
  }
  .drawer a:hover { background: #575757; }
  main { margin: 20px; }
</style>
<header>
  <a href="/index.html">← Back to Index</a>
  <button class="menu-btn" onclick="toggleDrawer()">☰ Menu</button>
</header>
<div id="drawer" class="drawer">
  <a href="__test__/terrapin.html">terrapin.html</a>
<a href="afd-slogan-generator.html">afd-slogan-generator.html</a>
<a href="blinker.html">blinker.html</a>
<a href="compose.html">compose.html</a>
<a href="edit-wave-info.html">edit-wave-info.html</a>
<a href="l2r.html">l2r.html</a>
<a href="midi2svg.html">midi2svg.html</a>
<a href="mlogo.html">mlogo.html</a>
<a href="mocr.html">mocr.html</a>
<a href="paint.html">paint.html</a>
<a href="radar.html">radar.html</a>
<a href="reinforcement-policy-neuron-network.html">reinforcement-policy-neuron-network.html</a>
<a href="sprite-detect.html">sprite-detect.html</a>
<a href="sprite.html">sprite.html</a>
<a href="stolzmonat.html">stolzmonat.html</a>
<a href="strwidth.html">strwidth.html</a>
<a href="svgtrace.html">svgtrace.html</a>
<a href="synth.html">synth.html</a>
<a href="terrapin.html">terrapin.html</a>
<a href="tetris.html">tetris.html</a>
<a href="timer.html">timer.html</a>
<a href="westerwald.html">westerwald.html</a>
</div>
<script>
  function toggleDrawer() {
    document.getElementById('drawer').classList.toggle('open');
  }
</script>
</body>
</html>
