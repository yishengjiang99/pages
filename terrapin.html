<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Terrapin Logo Emulator</title>
    <style>
        body {
            margin: 0;
            padding: 1vmin;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            height: 100vh;
            width: 100vw;
            overflow: hidden; /* Disable scrolling */
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            user-select: none; /* Disable text selection */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            box-sizing: border-box;
        }
        h1 {
            font-size: clamp(1rem, 3vmin, 1.5rem);
            margin: 1vmin 0;
            text-align: center;
        }
        #turtleCanvas {
            border: 1px solid black;
            width: clamp(200px, 90vmin, 400px);
            height: clamp(200px, 90vmin, 400px);
            background-color: #fff;
        }
        #commandInput {
            width: clamp(200px, 90vmin, 400px);
            height: 15vmin;
            margin: 1vmin 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 0.5vmin;
            font-family: 'Courier New', monospace;
            font-size: clamp(0.8rem, 2.5vmin, 1rem);
            resize: none;
            user-select: text; /* Allow text selection in editor */
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 0.5vmin;
            width: clamp(200px, 90vmin, 400px);
            margin: 0.5vmin 0;
        }
        button {
            padding: 0.5vmin;
            font-size: clamp(0.7rem, 2vmin, 0.9rem);
            border: 1px solid #333;
            background-color: #e0e0e0;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #d0d0d0;
        }
        button:active {
            background-color: #c0c0c0;
        }
        .command-buttons button {
            background-color: #4CAF50;
            color: white;
        }
        .command-buttons button:hover {
            background-color: #45a049;
        }
        .number-buttons button {
            background-color: #2196F3;
            color: white;
        }
        .number-buttons button:hover {
            background-color: #1e88e5;
        }
        .action-buttons button {
            background-color: #ff5722;
            color: white;
            font-weight: bold;
        }
        .action-buttons button:hover {
            background-color: #e64a19;
        }
        .action-buttons .reset-button {
            background-color: #f44336;
        }
        .action-buttons .reset-button:hover {
            background-color: #d32f2f;
        }
        .action-buttons .sample-button {
            background-color: #9c27b0;
        }
        .action-buttons .sample-button:hover {
            background-color: #7b1fa2;
        }
        @media (max-width: 600px) {
            .controls {
                grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
                gap: 0.3vmin;
            }
            button {
                padding: 0.4vmin;
                font-size: clamp(0.6rem, 1.8vmin, 0.8rem);
            }
            #commandInput {
                height: 20vmin;
            }
        }
    </style>
</head>
<body>
    <h1>Terrapin Logo Emulator</h1>
    <canvas id="turtleCanvas"></canvas>
    <textarea id="commandInput" placeholder="Enter Logo commands or use buttons below"></textarea>
    <div class="controls command-buttons">
        <button onclick="appendCommand('FORWARD')">FORWARD</button>
        <button onclick="appendCommand('BACK')">BACK</button>
        <button onclick="appendCommand('RIGHT')">RIGHT</button>
        <button onclick="appendCommand('LEFT')">LEFT</button>
        <button onclick="appendCommand('PENUP')">PENUP</button>
        <button onclick="appendCommand('PENDOWN')">PENDOWN</button>
        <button onclick="appendCommand('CLEARSCREEN')">CLEARSCREEN</button>
        <button onclick="appendCommand('HOME')">HOME</button>
    </div>
    <div class="controls number-buttons">
        <button onclick="appendCommand('10')">10</button>
        <button onclick="appendCommand('50')">50</button>
        <button onclick="appendCommand('100')">100</button>
    </div>
    <div class="controls action-buttons">
        <button class="run-button" onclick="runCommands()">Run Commands</button>
        <button class="reset-button" onclick="resetEditor()">Reset</button>
        <button class="sample-button" onclick="loadSample()">Sample</button>
    </div>

    <script>
        // Get canvas and editor
        const canvas = document.getElementById('turtleCanvas');
        const ctx = canvas.getContext('2d');
        const commandInput = document.getElementById('commandInput');

        // Set canvas size
        const setCanvasSize = () => {
            const size = Math.min(window.innerWidth * 0.9, window.innerHeight * 0.4, 400);
            canvas.width = size;
            canvas.height = size;
            initCanvas();
        };

        // Turtle state
        let turtle = {
            x: 0,
            y: 0,
            angle: 0,
            penDown: true
        };

        // Initialize canvas
        function initCanvas() {
            turtle.x = canvas.width / 2;
            turtle.y = canvas.height / 2;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            turtle.angle = 0;
            turtle.penDown = true;
            drawTurtle();
        }

        // Draw turtle
        function drawTurtle() {
            ctx.save();
            ctx.translate(turtle.x, turtle.y);
            ctx.rotate((turtle.angle * Math.PI) / 180);
            ctx.fillStyle = 'green';
            ctx.beginPath();
            ctx.moveTo(0, -10);
            ctx.lineTo(-5, 5);
            ctx.lineTo(5, 5);
            ctx.closePath();
            ctx.fill();
            ctx.restore();
        }

        // Append command to editor
        function appendCommand(cmd) {
            // If appending a number, add a line break; otherwise, add a space
            if (/\d+/.test(cmd)) {
                if (commandInput.value.endsWith(' ')) {
                    commandInput.value = commandInput.value.trimEnd() + ' ' + cmd + '\n';
                } else {
                    commandInput.value += cmd + '\n';
                }
            } else {
                commandInput.value += cmd + ' ';
            }
            commandInput.focus();
        }

        // Reset editor and canvas
        function resetEditor() {
            commandInput.value = '';
            initCanvas();
        }

        // Load sample sequence (draws a square)
        function loadSample() {
            commandInput.value = `FORWARD 100
RIGHT 90
FORWARD 100
RIGHT 90
FORWARD 100
RIGHT 90
FORWARD 100`;
            commandInput.focus();
        }

        // Parse and execute commands
        function runCommands() {
            const input = commandInput.value.toUpperCase().trim();
            const commands = input.split('\n').filter(cmd => cmd.trim() !== '');

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            commands.forEach(command => {
                // Split and filter out empty tokens
                const tokens = command.trim().split(/\s+/).filter(token => token !== '');
                const cmd = tokens[0];
                const arg = tokens[1] ? parseFloat(tokens[1]) : NaN;

                switch (cmd) {
                    case 'FORWARD':
                    case 'FD':
                        if (!isNaN(arg)) moveTurtle(arg);
                        else console.warn(`Invalid argument for ${cmd}: ${tokens[1]}`);
                        break;
                    case 'BACK':
                    case 'BK':
                        if (!isNaN(arg)) moveTurtle(-arg);
                        else console.warn(`Invalid argument for ${cmd}: ${tokens[1]}`);
                        break;
                    case 'RIGHT':
                    case 'RT':
                        if (!isNaN(arg)) turtle.angle = (turtle.angle + arg) % 360;
                        else console.warn(`Invalid argument for ${cmd}: ${tokens[1]}`);
                        break;
                    case 'LEFT':
                    case 'LT':
                        if (!isNaN(arg)) turtle.angle = (turtle.angle - arg) % 360;
                        else console.warn(`Invalid argument for ${cmd}: ${tokens[1]}`);
                        break;
                    case 'PENUP':
                    case 'PU':
                        turtle.penDown = false;
                        break;
                    case 'PENDOWN':
                    case 'PD':
                        turtle.penDown = true;
                        break;
                    case 'CLEARSCREEN':
                    case 'CS':
                        initCanvas();
                        break;
                    case 'HOME':
                        turtle.x = canvas.width / 2;
                        turtle.y = canvas.height / 2;
                        turtle.angle = 0;
                        break;
                    default:
                        console.warn(`Unknown command: ${cmd}`);
                }
            });

            drawTurtle();
        }

        // Move turtle
        function moveTurtle(distance) {
            if (isNaN(distance)) return;
            const rad = (turtle.angle * Math.PI) / 180;
            const newX = turtle.x + distance * Math.cos(rad);
            const newY = turtle.y - distance * Math.sin(rad);

            if (turtle.penDown) {
                ctx.beginPath();
                ctx.moveTo(turtle.x, turtle.y);
                ctx.lineTo(newX, newY);
                ctx.strokeStyle = 'black';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            turtle.x = newX;
            turtle.y = newY;
        }

        // Initialize and handle resize
        window.addEventListener('resize', setCanvasSize);
        setCanvasSize();
    </script>
</body>
</html>