<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Terrapin Logo Emulator</title>
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <style>
        body {
            margin: 0;
            padding: 1vmin;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            height: 100vh;
            width: 100vw;
            overflow: hidden; /* Disable scrolling */
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            user-select: none; /* Disable text selection */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            box-sizing: border-box;
        }
        h1 {
            font-size: clamp(1rem, 3vmin, 1.5rem);
            margin: 1vmin 0;
            text-align: center;
        }
        #turtleCanvas {
            border: 1px solid black;
            width: clamp(200px, 90vmin, 400px);
            height: clamp(200px, 90vmin, 400px);
            background-color: #fff;
        }
        .editor-container {
            width: clamp(200px, 90vmin, 400px);
            height: 15vmin;
            margin: 1vmin 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            overflow: auto;
        }
        #commandInput {
            width: 100%;
            height: 100%;
            border: none;
            padding: 0.5vmin;
            font-family: 'Courier New', monospace;
            font-size: clamp(0.8rem, 2.5vmin, 1rem);
            resize: none;
            background: transparent;
            user-select: text; /* Allow text selection in editor */
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 0.5vmin;
            width: clamp(200px, 90vmin, 400px);
            margin: 0.5vmin 0;
        }
        button {
            padding: 0.5vmin;
            font-size: clamp(0.7rem, 2vmin, 0.9rem);
            border: 1px solid #333;
            background-color: #e0e0e0;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #d0d0d0;
        }
        button:active {
            background-color: #c0c0c0;
        }
        .command-buttons button {
            background-color: #4CAF50;
            color: white;
        }
        .command-buttons button:hover {
            background-color: #45a049;
        }
        .number-buttons button {
            background-color: #2196F3;
            color: white;
        }
        .number-buttons button:hover {
            background-color: #1e88e5;
        }
        .run-button {
            background-color: #ff5722;
            color: white;
            font-weight: bold;
        }
        .run-button:hover {
            background-color: #e64a19;
        }
        @media (max-width: 600px) {
            .controls {
                grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
                gap: 0.3vmin;
            }
            button {
                padding: 0.4vmin;
                font-size: clamp(0.6rem, 1.8vmin, 0.8rem);
            }
            .editor-container {
                height: 20vmin;
            }
        }
    </style>
</head>
<body>
    <h1>Terrapin Logo Emulator</h1>
    <canvas id="turtleCanvas"></canvas>
    <div class="editor-container">
        <pre><code id="commandInput" class="language-logo" contenteditable="true" spellcheck="false">FORWARD 100
RIGHT 90</code></pre>
    </div>
    <div class="controls command-buttons">
        <button onclick="appendCommand('FORWARD ')">FORWARD</button>
        <button onclick="appendCommand('BACK ')">BACK</button>
        <button onclick="appendCommand('RIGHT ')">RIGHT</button>
        <button onclick="appendCommand('LEFT ')">LEFT</button>
        <button onclick="appendCommand('PENUP')">PENUP</button>
        <button onclick="appendCommand('PENDOWN')">PENDOWN</button>
        <button onclick="appendCommand('CLEARSCREEN')">CLEARSCREEN</button>
        <button onclick="appendCommand('HOME')">HOME</button>
    </div>
    <div class="controls number-buttons">
        <button onclick="appendCommand('10')">10</button>
        <button onclick="appendCommand('50')">50</button>
        <button onclick="appendCommand('100')">100</button>
    </div>
    <div class="controls">
        <button class="run-button" onclick="runCommands()">Run Commands</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script>
        // Define Prism.js language for Logo
        Prism.languages.logo = {
            'keyword': /\b(FORWARD|FD|BACK|BK|RIGHT|RT|LEFT|LT|PENUP|PU|PENDOWN|PD|CLEARSCREEN|CS|HOME)\b/i,
            'number': /\b\d+\b/,
            'string': /".*?"/,
            'comment': /;.*/
        };

        // Get canvas and editor
        const canvas = document.getElementById('turtleCanvas');
        const ctx = canvas.getContext('2d');
        const commandInput = document.getElementById('commandInput');

        // Set canvas size
        const setCanvasSize = () => {
            const size = Math.min(window.innerWidth * 0.9, window.innerHeight * 0.4, 400);
            canvas.width = size;
            canvas.height = size;
            initCanvas();
        };

        // Turtle state
        let turtle = {
            x: 0,
            y: 0,
            angle: 0,
            penDown: true
        };

        // Initialize canvas
        function initCanvas() {
            turtle.x = canvas.width / 2;
            turtle.y = canvas.height / 2;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            turtle.angle = 0;
            turtle.penDown = true;
            drawTurtle();
        }

        // Draw turtle
        function drawTurtle() {
            ctx.save();
            ctx.translate(turtle.x, turtle.y);
            ctx.rotate((turtle.angle * Math.PI) / 180);
            ctx.fillStyle = 'green';
            ctx.beginPath();
            ctx.moveTo(0, -10);
            ctx.lineTo(-5, 5);
            ctx.lineTo(5, 5);
            ctx.closePath();
            ctx.fill();
            ctx.restore();
        }

        // Append command to editor
        function appendCommand(cmd) {
            commandInput.textContent += cmd + ' ';
            Prism.highlightElement(commandInput);
            commandInput.focus();
        }

        // Parse and execute commands
        function runCommands() {
            const input = commandInput.textContent.toUpperCase().trim();
            const commands = input.split('\n');

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            commands.forEach(command => {
                const tokens = command.trim().split(' ');
                const cmd = tokens[0];
                const arg = parseFloat(tokens[1]);

                switch (cmd) {
                    case 'FORWARD':
                    case 'FD':
                        moveTurtle(arg);
                        break;
                    case 'BACK':
                    case 'BK':
                        moveTurtle(-arg);
                        break;
                    case 'RIGHT':
                    case 'RT':
                        turtle.angle = (turtle.angle + arg) % 360;
                        break;
                    case 'LEFT':
                    case 'LT':
                        turtle.angle = (turtle.angle - arg) % 360;
                        break;
                    case 'PENUP':
                    case 'PU':
                        turtle.penDown = false;
                        break;
                    case 'PENDOWN':
                    case 'PD':
                        turtle.penDown = true;
                        break;
                    case 'CLEARSCREEN':
                    case 'CS':
                        initCanvas();
                        break;
                    case 'HOME':
                        turtle.x = canvas.width / 2;
                        turtle.y = canvas.height / 2;
                        turtle.angle = 0;
                        break;
                    default:
                        console.warn(`Unknown command: ${cmd}`);
                }
            });

            drawTurtle();
        }

        // Move turtle
        function moveTurtle(distance) {
            if (isNaN(distance)) return;
            const rad = (turtle.angle * Math.PI) / 180;
            const newX = turtle.x + distance * Math.cos(rad);
            const newY = turtle.y - distance * Math.sin(rad);

            if (turtle.penDown) {
                ctx.beginPath();
                ctx.moveTo(turtle.x, turtle.y);
                ctx.lineTo(newX, newY);
                ctx.strokeStyle = 'black';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            turtle.x = newX;
            turtle.y = newY;
        }

        // Initialize and handle resize
        window.addEventListener('resize', setCanvasSize);
        setCanvasSize();
        Prism.highlightElement(commandInput);
    </script>
</body>
</html>